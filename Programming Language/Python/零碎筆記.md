### ä¿ç•™å­—

|   |   |   |   |   |   |   |   |   |
|---|---|---|---|---|---|---|---|---|
|False|True|None|and|as|[[assert]]|break|class|continue|
|def|del|elif|else|except|finally|for|from|global|
|if|[[import]]|in|is|lambda|nonlocal|not|or|pass|
|raise|return|try|while|[[Context Manager & with\|with]]|yield|

---

### å‘½åè¦å‰‡

- ç¡¬æ€§è¦å®š
    - Variableã€functionã€class çš„åç¨±ä¸èƒ½ç‚ºä¿ç•™å­—
    - Variableã€functionã€class çš„åç¨±ä¸èƒ½ä»¥æ•¸å­—é–‹é ­
- ç¤¾ç¾¤ç¿’æ…£
    - ä»¥ snake_case å‘½å variableã€functionã€module èˆ‡ package
    - Class åç¨±æœƒä»¥å¤§å¯«é–‹é ­
    - å¸¸æ•¸æœƒä»¥å…¨å¤§å¯«çš„ SNAKE_CASE å‘½å

---

### å–„ç”¨ç§‘å­¸è¨˜è™Ÿè¡¨ç¤ºå¾ˆå¤§æˆ–å¾ˆå°çš„æ•¸å­—

e.g. `1e20`, `1e-5`

>[!Note]
>ç§‘å­¸è¨˜è™Ÿçš„å‹åˆ¥æ˜¯ `float` ä¸æ˜¯ `int`ã€‚

---

### The Walrus Operator (`:=`)

åœ¨ ==Python 3.8 ä¹‹å¾Œ==ï¼Œå¯ä»¥åœ¨ `if`ã€`for` èˆ‡ `while` statement ä¸­ä½¿ç”¨ walrus operatorã€‚

e.g.

```Python
# Before Python 3.8
l = len(s)
if l > 2:
    print(l)

# Since Python 3.8
if (l := len(s)) > 2:
    print(l)
```

>[!Note]
>ä½¿ç”¨ walrus operator æ™‚é ˆè¨˜å¾—åŠ ä¸Šå¿…è¦çš„ `( )`ï¼Œå¦å‰‡æ„æ€å¯èƒ½å®Œå…¨ä¸åŒã€‚
>
>æ¯”å¦‚åƒä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ`l` æ˜¯ `len(s)`ï¼ˆä¸€å€‹ `int`ï¼‰ï¼Œä½†è‹¥å°‘äº†å¤–é¢çš„ `( )`ï¼ˆä¹Ÿå°±æ˜¯å¯«æˆ `if l := len(s) > 2`ï¼‰å‰‡é€™æ™‚å€™ `l` å°±æœƒè®Šæˆ `len(2) > 2`ï¼ˆä¸€å€‹ `bool`ï¼‰ã€‚

---

### è¨»è§£

```Python
# é€™æ˜¯å–®è¡Œè¨»è§£

"""
é€™æ˜¯
å¤šè¡Œ
è¨»è§£
"""
```

---

### ç„¡é™

```Python
float("inf")  # æ­£ç„¡é™å¤§
float("-inf")  # è² ç„¡é™å¤§

# or
import math

math.inf  # æ­£ç„¡é™å¤§
-math.inf  # è² ç„¡é™å¤§
```

---

### Tuple vs List

- å»ºç«‹ tuple æ¯”å»ºç«‹ list å¿« 10 å€å·¦å³
- List ä½”ç”¨çš„è¨˜æ†¶é«”è¼ƒ tuple å¤§ 5% å·¦å³
    - é€™å€‹ç‰¹è‰²åªå‡ºç¾åœ¨ç”¨ `[ ]` èªæ³•å»ºç«‹çš„ listï¼›ç”¨ `list` function å»ºç«‹çš„ list å°±æ²’æœ‰é€™å€‹ç¼ºé»
- Tuple is immutable, while list is mutable.

---

### Deque

Python å…§å»ºçš„ `collections` library ä¸­æœ‰ `deque` è³‡æ–™çµæ§‹ï¼Œdeque å°±æ˜¯åœ¨é ­ã€å°¾éƒ½å¯ä»¥ç”¨ $O(1)$ çš„æ™‚é–“è¤‡é›œåº¦é€²è¡Œ push èˆ‡ pop çš„ queueã€‚ç”¨æ³•å¦‚ä¸‹ï¼š

```Python
from collections import deque

d = deque([1, 2, 3, 4])
d.append(5)
d.pop()
d.appendleft(0)
d.popleft()
```

ä¸‹æ–¹æ˜¯ deque èˆ‡ list çš„å„ç¨® method çš„æ™‚é–“é›œåº¦æ¯”è¼ƒè¡¨ï¼ˆ[åƒè€ƒè³‡æ–™](https://wiki.python.org/moin/TimeComplexity)ï¼‰ï¼š

| |List|Deque|
|:-:|:-:|:-:|
|push tail|$O(1)$|$O(1)$|
|pop tail|$O(1)$|$O(1)$|
|push head|$O(n)$|$O(1)$|
|pop head|$O(n)$|$O(1)$|

---

### Set

- `s.remove(x)` æ™‚ï¼Œè‹¥ set `s` æœ¬ä¾†å°±æ²’æœ‰ `x`ï¼Œå‰‡æœƒ raise `KeyError`ï¼›ä½†è‹¥ä½¿ç”¨ `s.discard(x)` å°±ä¸æœƒ raise error
- è¨­ `s1`, `s2` ç‚ºå…©å€‹ setsï¼Œ`s1.update(s2)` èˆ‡ `s1 |= s2` çš„æ•ˆæœç›¸åŒï¼ˆ`s1` éƒ½æœƒè®ŠæˆåŸ `s1` èˆ‡ `s2` çš„è¯é›†ï¼‰
- `set("hello")` æœƒå›å‚³ `{"e", "h", "l", "o"}`ï¼Œä¸æ˜¯ `{"hello"}`
    - åŒç†ï¼Œ`list("hello")` æœƒå›å‚³ `["e", "h", "l", "o"]`ï¼Œ`tuple("hello")` æœƒå›å‚³ `("e", "h", "l", "o")`

---

### `__name__ == "__main__"`

æ¯ä¸€å€‹ Python **package** ä»¥åŠ **module** éƒ½æœƒæœ‰ `__name__` é€™å€‹ attributeï¼Œ==ä¸€å€‹ module åœ¨è‡ªå·±å…§éƒ¨å–è‡ªå·±çš„ `__name__` æœƒå¾—åˆ° `"__main__"`==ï¼›å–å…¶ä»–è¢« import é€²ä¾†çš„ packages æˆ– modules çš„ `__name__` å°±ä¸æœƒå¾—åˆ° `"__main__"`ã€‚

å‡è¨­ä¸€å€‹ module å« `hello`ï¼Œç•¶ `hello` è¢« import é€²å¦ä¸€å€‹ module `world` æ™‚ï¼Œ`hello` åœ¨ `world` ä¸­çš„ `__name__` æœƒæ˜¯  `"hello"`ï¼›è‹¥ `hello` æ˜¯å±¬æ–¼ package `mypackage` çš„ moduleï¼Œå‰‡ `__name__` æœƒæ˜¯  `"mypackage.hello"`ã€‚

æ‰€ä»¥åœ¨ module å…§éƒ¨æ™‚å¸¸æœƒçœ‹åˆ° `if __name__ == "__main__":` é€™æ¨£çš„ block å‡ºç¾åœ¨æœ€å¾Œï¼Œé€™å€‹ block çš„ç”¨æ„å°±æ˜¯å‘Šè¨´ Python interpreterï¼šã€Œåªæœ‰åœ¨ç›´æ¥åŸ·è¡Œé€™å€‹ module æ™‚æ‰é ˆè¦åŸ·è¡Œ block å…§çš„ç¨‹å¼ç¢¼ï¼›åä¹‹ï¼Œè‹¥å¾å…¶ä»– module import é€™å€‹ moduleï¼Œå°±ä¸è¦åŸ·è¡Œé€™å€‹ block å…§çš„ç¨‹å¼ã€‚ã€åˆ©ç”¨é€™å€‹ç‰¹æ€§ï¼Œé€™å€‹ block å¯ä»¥æ‹¿ä¾†å¯« module å…§éƒ¨çš„ unit testã€‚

>[!Info]
>ç›´æ¥åŸ·è¡Œä¸€å€‹ module æ™‚ï¼Œå°å‡ºçš„ `__name__` (`"__main__"`) ä¸¦ä¸æ˜¯ module çš„ `__name__`ï¼Œè€Œæ˜¯ **top-level code enrironment** çš„ `__name__`ã€‚

---

### ä½¿ç”¨ CLI åŸ·è¡Œ Python æ™‚å¸¸æ­é…ä½¿ç”¨çš„ Options

##### `-m`

ä»¥ module çš„ `__name__` åŸ·è¡ŒæŒ‡å®šçš„ moduleã€‚æ‰€ä»¥ä¸‹é¢å…©å€‹çš„æŒ‡ä»¤æ•ˆæœæ˜¯ä¸€æ¨£çš„ï¼š

```bash
python ./hello/world.py

# or

python -m hello.world
```

##### `-B`

åŸ·è¡Œ Python æ™‚ï¼Œä¸æœƒè©¦åœ–è®€å–æˆ–å¯«å…¥ä»»ä½• `.pyc` æª”ï¼Œå› æ­¤ä¹Ÿå°±ä¸æœƒç”¢ç”Ÿ `__pycache__` directoryã€‚é€™æ„å‘³è‘— Python interpreter é ˆè¦å°‡ source code å®Œæ•´çš„ interpretï¼Œä¸èƒ½ç›´æ¥æ‹¿é å…ˆç·¨è­¯å¥½çš„ bytecode ä¾†åŸ·è¡Œï¼Œæ‰€ä»¥æœƒåŸ·è¡Œåœ°æ¯”è¼ƒæ…¢ã€‚

---

### å–„ç”¨ Lazy Evaluation é¿å…ä¸å¿…è¦çš„è¨ˆç®—

Lazy evaluation æ³›æŒ‡ã€Œé ˆè¦é‹ç®—æ™‚æ‰é‹ç®—ã€é€™ç¨® design patternã€‚åœ¨ Python ä¸­ä¸»è¦æœ‰å…©ç¨®å¯¦ç¾ lazy evaluation çš„æ’°å¯«æ–¹å¼ï¼Œåˆ†åˆ¥æ˜¯ iterator ä»¥åŠ cached propertyã€‚

##### ä½¿ç”¨ Iterator å¯¦ç¾

Iterator æœ‰ä¸€å€‹ [[Super Method]] å«åš `__next__`ï¼Œé€éå‘¼å«é€™å€‹ method è¨ˆç®—ä¸¦å–å¾— iterator çš„ã€Œä¸‹ä¸€å€‹ã€å€¼ï¼Œè€Œä¸æ˜¯äº‹å…ˆå°‡æ‰€æœ‰å¯èƒ½ç”¨åˆ°çš„å€¼è¨ˆç®—å‡ºä¾†ï¼ˆè©³è¦‹[[Iterable & Iterator#Iterator|æœ¬æ–‡]]ï¼‰ã€‚

[[Generator and the yield Statement|Generator]] ä¹Ÿæ˜¯ Iterator çš„ä¸€ç¨®ï¼Œæ‰€ä»¥ä¹Ÿæœ‰ lazy evaluation çš„ç‰¹æ€§ã€‚

##### ä½¿ç”¨ Cached Property å¯¦ç¾

Cached property çš„ç²¾ç¥ç°¡è¨€ä¹‹å°±æ˜¯ã€Œè¨ˆç®—éçš„æ±è¥¿å°±ä¸è¦å†ç®—ä¸€æ¬¡äº†ã€ï¼Œè©³æƒ…å¯è¦‹ [[Property of a Class]]ã€‚

---

### ä¸è¦ç”¨ `type` åšå‹åˆ¥æª¢æŸ¥

æœ‰äº›æ™‚å€™ `type` çš„çµæœä¸¦ä¸ä¸€å®šæº–ç¢ºï¼Œå»ºè­°ä½¿ç”¨ `isinstance` ä¾†åšå‹åˆ¥æª¢æŸ¥ï¼Œæˆ–ä½¿ç”¨ `hasattr` ä¾†æª¢æŸ¥ç‰©ä»¶æ˜¯å¦å…·æœ‰è¦æ±‚çš„ attributesã€‚

---

### `eval` å®¹æ˜“æœ‰å®‰å…¨æ¼æ´

#TODO 

---

### ä¸è¦å–®ç¨ä½¿ç”¨ `except:` 

ç›¡é‡ä½¿ç”¨ `except XXError:` æˆ–æ›´å®Œæ•´çš„ `except XXError as e:`ã€‚

---

### æ—‹è½‰ 2D List

```Python
m = [[1, 2], [3, 4]]

# é †æ™‚é‡
list(zip(*m[::-1]))  # [(3, 1), (4, 2)]

# é€†æ™‚é‡
list(zip(*m))[::-1]  # [(2, 4), (1, 3)]
```

---

### List Comprehension

```python
l = [i**2 for i in range(10)]

# is equivalent to

l = []
for i in range(10):
    l.append(i**2)
```

- è«‹æ³¨æ„å®ƒèˆ‡ [[Generator and the yield Statement#Generator Expression|generator  expression]] çš„å·®ç•°
- List comprehension æ¯” for loop + `append` æœ‰æ•ˆç‡

### Set Comprehension

```Python
l = [1, 2, 2, 3]

# The result of the following three approaches are same:

# Approach 1 (Set Conversion)
s = set(l)

# Approach 2 (Set Comprehension)
s = {num for num in l}

# Approach 3
s = set()
for num in l:
    s.add(num)
```

- èˆ‡ list comprehension é¡ä¼¼ï¼Œset comprehension æ¯” for loop + `add` æœ‰æ•ˆç‡

### Dict Comprehension

```Python
l = [["a", 1], ["b", 2], ["c", 3]]

# The result of the following two approaches are same:

# Approach 1 (Dict Conversion)
d = dict(l)

# Approach 2 (Dict Comprehension)
d = {k: v for k, v in l}
```

---

### Flatten 2D List

##### æ–¹æ³•ä¸€ ğŸ‘ğŸ»ï¼š`sum`

```Python
m = [[1, 2], [3, 4]]
sum(m, [])  # [1, 2, 3, 4]
```

ä¸æ¨è–¦ä½¿ç”¨é€™å€‹æ–¹æ³•ï¼Œå› ç‚º `sum` åœ¨æ¯æ¬¡ iteration ä¸­ï¼Œæœƒè¤‡è£½ä¸€ä»½è¦è¢«åŠ é€² flatten list çš„å…ƒç´ ã€‚

##### æ³•äºŒ ğŸ‘ğŸ»ï¼šList Comprehension

```Python
m = [[1, 2], [3, 4]]
[i for l in m for i in l]  # [1, 2, 3, 4]
```

---

### Chained Assignment

```Python
a = b = 10;

# is equivalent to

a = 10
b = 10
```

ç•¶ assign çµ¦å„å€‹è®Šæ•¸çš„å€¼çš„å‹æ…‹æ˜¯åŸºæœ¬è³‡æ–™å‹æ…‹æ™‚ï¼Œå„è®Šæ•¸é–“ä¸æœƒé€£å‹•ï¼›ä½†è‹¥ assign çµ¦å„è®Šæ•¸çš„å€¼æ˜¯ä¸€å€‹ mutable object æ™‚ï¼Œå„è®Šæ•¸é–“å°±æœƒé€£å‹•ã€‚èˆ‰ä¾‹ä¾†èªªï¼š

```Python
i = j = 10
i = 0
print(i, j)  # 0, 10

a = b = []
a[0] = 0
print(a, b)  # [0], [0]
```

---

### `enumerate`

ä½¿ç”¨ `enumerate` åŒæ™‚ç²å–åºåˆ—è¿­ä»£çš„ index å’Œ valueï¼š

```Python
l = ['a', 'b', 'c']
for idx, char in enumerate(l):
    print(idx, char)
# 0, 'a'
# 1, 'b'
# 2, 'c'
```

---

### ä½¿ç”¨ `get` è™•ç† Dictionary ä¸­æ‰¾ä¸åˆ° Key çš„ç‹€æ³

```Python
aDict[k] = aDict.get(k, 0) + 1

# is equivalent to

if k in aDict:
    aDict[k] += 1
else:
    aDict[k] = 1
```

---

### ç”¨ Dictionary åšå­—ä¸²æ ¼å¼åŒ–

```Python
info = {"name": "Bob", "age": 25}
greeting = "My name is %(name)s. I'm %(age)s years old." % info
```

---

### ä½¿ç”¨ `contextlib.suppress` å–ä»£ `try-except-pass`

[å®˜æ–¹æ–‡ä»¶](https://docs.python.org/3/library/contextlib.html#contextlib.suppress)

```Python
from contextlib import suppress

with suppress(FileNotFoundError):
    os.remove('somefile.tmp')

# is equivalent to

try:
    os.remove('somefile.tmp')
except FileNotFoundError:
    pass
```

---

### ã€Œæœ‰é †åºåœ°ã€é¸å‡º List ä¸­çš„ Distinct Values

ä»¥ä¸€å€‹å«æœ‰è‹¥å¹² characters çš„ list `l` ç‚ºä¾‹ï¼Œä½¿ç”¨ `set(l)` æˆ– [[#Set Comprehension]] é¸å‡ºçš„ characters é †åºæœƒè¢«æ‰“äº‚ï¼Œä¸ä¸€å®šæœƒèˆ‡æœ¬ä¾† `l` ä¸­çš„é †åºä¸€æ¨£ã€‚

è‹¥æƒ³è¦ç¶­æŒé †åºï¼Œå‰‡å¯ä»¥ä½¿ç”¨ `dict.fromkeys`ï¼š

```Python
l = ["a", "c", "b", "a", "d", "a"]
s = list(dict.fromkeys(l))
```

`dict.fromekeys` æœƒå°‡ç¬¬ä¸€å€‹ä½ç½®çš„åƒæ•¸ï¼ˆå¿…é ˆæ˜¯ä¸€å€‹ [[Iterable & Iterator|iterable]]ï¼‰ä¸­çš„å…ƒç´ æŒ‰ç…§é †åºé€ä¸€æ”¾å…¥ä¸€å€‹åŸæœ¬ç‚ºç©ºçš„ dictionaryï¼Œç”±æ–¼åœ¨ ==Python 3.7 å¾Œï¼Œdictionary ä¸­çš„ keys æ˜¯æœ‰é †åºçš„==ï¼Œé€™å€‹é †åºå°±æ˜¯ã€Œæ¯å€‹ key ç¬¬ä¸€æ¬¡è¢«å¡å…¥ dictionary çš„é †åºã€ï¼Œå› æ­¤é€™å€‹åšæ³•å¯ä»¥åœ¨ç¶­æŒå…ƒç´ åœ¨åŸ iterable ä¸­çš„é †åºçš„æƒ…æ³ä¸‹ï¼Œä¿è­‰å…ƒç´ çš„å”¯ä¸€æ€§ã€‚

---

### å°å‡ºæ–¹ä¾¿é–±è®€çš„ Dictionary

##### ä½¿ç”¨ `pprint`

```Python
from pprint import pprint

sample_dict = {
    'name': 'Nick',
    'age': 31,
    'gender': 'male',
    'books': ['Harry Potter', 'Lord of the Rings'],
}
pprint.pprint(sample_dict)

# {'name': 'Nick',
#   'age': 31,
#   'books': ['Harry Potter', 'Lord of the Rings'],
#   'gender': 'male'}
```

##### ä½¿ç”¨ `json.dumps`

```Python
import json

print(json.dumps(sample_dict, indent=4))

# {
#     "name": "Nick",
#     "age": 31,
#     "gender": "male",
#     "books": [
#         "Harry Potter",
#         "Lord of the Rings"
#     ]
# }
```

---

### `is None` vs `== None`

å…©ç¨®å¯«æ³•éƒ½å°ï¼Œä½† `is None` æ›´ Pythonicã€‚

---

### Counter

```Python
from collections import Counter

s = "aaaaabbbcccccc"
c = Counter(s)
print(c)  # Counter({'c': 6, 'a': 5, 'b': 3})
print(c.most_common(1))  # [('c', 6)]
```

---

### ç’°å¢ƒè®Šæ•¸ `PYTHONDONTWRITEBYTECODE`

è‹¥åœ¨ç’°å¢ƒè®Šæ•¸ä¸­è¨­å®š `PYTHONDONTWRITEBYTECODE=1`ï¼Œå‰‡åŸ·è¡Œ Python æª”æ¡ˆæ™‚ä¸æœƒç”¢ç”Ÿ .pyc æª”ã€‚

---

### Numba

#package 

[å®˜æ–¹æ–‡ä»¶](https://numba.readthedocs.io/en/stable/index.html)

å¦‚æœä½ çš„ç¨‹å¼ç¢¼æœ‰å¾ˆå¤šæ•¸å­¸é‹ç®—ã€å¾ˆå¤š loopsã€æˆ–å¾ˆå¤š NumPy array çš„æ“ä½œï¼ŒNumba é€™å€‹å¥—ä»¶å¯ä»¥é€é [[Compilation vs Interpretation#JIT Compilation|JIT compilation]] æœ‰æ•ˆåŠ é€Ÿ CPU åŸ·è¡Œç¨‹å¼ç¢¼çš„æ•ˆç‡ã€‚

---

### orjson

#package 

- <https://myapollo.com.tw/blog/python-orjson/>

---

### Built-in LRU Cache

#Caching 

Python å…§å»ºçš„ `functools` library æœ‰æä¾› `lru_cache` decoratorï¼Œå¯ä»¥ç”¨ä¾† cache function resultã€‚ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š

```Python
from functools import lru_cache

@lru_cache(maxsize=None)
def fib_recursive(n: int) -> int:
    if n < 2:
        return n
    return fib_recursive(n - 1) + fib_recursive(n - 2)
```

å¾ä¸Šé¢çš„ä¾‹å­å¯è¦‹ï¼Œæœ‰äº† `lru_cache`ï¼Œæœ‰äº›æœ¬ä¾†éœ€è¦ [[Dynamic Programming.canvas|Dynamic Programming]] çš„åœ°æ–¹å°±å¯ä»¥ä¸ç”¨å¦å¤–å¯¦ä½œäº†ã€‚

---

### åœ¨ Module å…§å–å¾—ç›®å‰çš„æª”æ¡ˆè·¯å¾‘

```Python
from pathlib import Path

Path(__file__)
```

---

### `sorted` çš„ç”¨æ³•

```Python
l = [1, 3, 2, 5, 4]
s = sorted(l)
print(s)  # [1, 2, 3, 4, 5]
```

- `sorted(l)` æœƒå›å‚³ä¸€å€‹æ–°çš„çµæœï¼Œä¸æœƒå‹•åˆ° `l`ï¼›ç›¸ååœ°ï¼Œ`l.sort()` æœƒ in-place æ›´æ”¹`l` å…§çš„å…ƒç´ é †åº

- ä½¿ç”¨åƒæ•¸ `key` æ§åˆ¶è¦ç”¨æ¯å€‹å…ƒç´ çš„å“ªå€‹éƒ¨åˆ†ä½œç‚ºæ’åºçš„ä¾æ“š

    ```Python
    l = [['a', 2], ['b', 1], ['a', 1]]

    # æ¯”è¼ƒæ¯å€‹å…ƒç´ çš„ index 0
    s1 = sorted(l, key=lambda x: x[0])
    print(s1)  # [['a', 2], ['a', 1], ['b', 1]]

    # æ¯”è¼ƒæ¯å€‹å…ƒç´ çš„ index 1
    s2 = sorted(l, key=lambda x: x[1])
    print(s2)  # [['b', 1], ['a', 1], ['a', 2]]

    # å…ˆæ¯”è¼ƒæ¯å€‹å…ƒç´ çš„ index 0, index 0 ç›¸åŒè€…å†æ¯”å° index 1
    s3 = sorted(l, key=lambda x: (x[0], x[1]))
    print(s3)  # [['a', 1], ['a', 2], ['b', 1]]
    ```

- ä½¿ç”¨åƒæ•¸ `reverse` æ§åˆ¶è¦å‡å†ªæˆ–é™å†ªæ’åº
    - `reverse=True` ä»£è¡¨è¦é™å†ª
    - `reverse` é è¨­ç‚º `False`

---
