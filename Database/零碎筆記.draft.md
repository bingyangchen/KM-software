### RDBMS 中的複雜資料型態

在早期，所有 column 的資料型態都必須是 scalar (atomic)，但後來 RDBMS 漸漸可以支援 array、json 等格式複雜的資料。

---

### Caching in Database

DBMS 通常會把一些經常被讀取到的資料放在 main memory 中，達到加快存取速度的效果。比如 MySQL InnoDB engine 的 [buffer pool](</Database/MySQL/Buffer Pool of InnoDB.md>)。

---

### 資料在 RDBMS 中的順序

我們都說「資料在 RDBMS 中是無序的」，然而這並不代表每次 `SELECT` 資料時所拿到的資料順序都是完全隨機的，因為資料在資料庫中確實是被存在某種資料結構中了，也必定有一個預設用來 traverse 該資料結構的演算法，所以資料的順序應該說是「某種程度上」可預期的，只是並非「完全可預期」，因為有一些因素會影響到資料在資料結構中的位置，進而影響到 `SELECT` 時所得到的順序（這些因素包括 DBMS 所採用的 storage engine、單筆資料的大小...... 等）。

你可以把資料庫想像成一個圖書館，給定某一個時間點，裡面的書當然有一定的順序，但隨著人進進出出，有時將書借走但歸還時放在不同地方，這些書的順序難免會不一樣，但也不會說每次觀測時順序都跟上一刻完全不同。

若想要確保每次得到的資料都以特定規則排序，則必須加上 `ORDER BY`（詳見 [使用 ORDER BY 排序](</Database/SQL/DML.md#使用 ORDER BY 排序>)）。

---

### 在資料庫中排序資料 vs 寫程式排序資料

在應用程式的後端服務中，當我們要撈取一堆資料並且要對這些資料進行排序時，可以選擇直接在 SQL 裡寫 `ORDER BY`，也可以選擇將資料以無序的方式撈出、自己寫程式排序。在這兩個做法間該怎麼選擇呢？以下提供幾個思考點：

- I/O
    - 有時後我們只是要依某欄位排序後「其它欄位的值」，並不須要該欄位本身的值，寫 SQL 排序的話可以不回傳該欄的值，但若用程式排序就一定要將該欄的值從 DBMS 傳給 application server，造成不必要的 I/O
    - 有時後我們要的是所有資料排序後的前 n 筆，此時若用程式排序就要將所有資料傳給 application server，顯得更不必要（而且有時候所有資料可能會塞爆 application server 的 memory）
- 速度
    - 雖然 DB 是將資料存在 disk 裡，但排序時也會用到 memory，所以速度不會慢太多（要排序的資料量太大的話就會併用 memory 與 disk）
- Cache
    - 寫 SQL 排序的話，DBMS 有內建 cache 可供下次直接取用
    - 寫程式排序的話要額外用 cache service 才能達到 cache 的效果
- 效能瓶頸
    - 寫 SQL 排序消耗的是 DBMS 的資源；寫程式排序消耗的是 application server 的資源，所以如果沒有前述的 cache、I/O 問題，那就可以選擇比較不容易遇到效能瓶頸的那個

---
